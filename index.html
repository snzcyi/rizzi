<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Polaroids</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  height: 100%;
  background: url('bg.jpg') center/cover no-repeat fixed;
  touch-action: none;
}

#viewport {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
}

#canvas {
  position: absolute;
  width: 200vw;
  height: 170vh;

  display: grid;
  grid-template-columns: repeat(6, 1fr); /* 6 per row */
  grid-template-rows: repeat(5, auto);   /* 5 rows */

  gap: 60px;
  padding: 100px;
  transform-origin: 0 0;
  cursor: grab;
}

.polaroid {
  background: #f9f9f7;
  padding: 10px 10px 25px;
  box-shadow:
    0 10px 25px rgba(0,0,0,0.4),
    inset 0 0 2px rgba(0,0,0,0.2);
}

.polaroid img {
  width: 100%;
  display: block;
  filter: contrast(0.95) sepia(0.08);
}
</style>
</head>

<body>

<div id="viewport">
<div id="canvas">

<script>
for (let i = 1; i <= 30; i++) {
  const tilt = (Math.random() * 8 - 4).toFixed(2); // slight tilt
  document.write(`
    <div class="polaroid" style="transform: rotate(${tilt}deg);">
      <img src="${i}.JPG">
    </div>
  `);
}
</script>

</div>
</div>

<audio id="bgm" src="paris.mp3" autoplay loop></audio>

<script>
const canvas = document.getElementById("canvas");

let scale = 1;
let minScale = 0.6;
let maxScale = 2.5;
let offsetX = -window.innerWidth * 0.25;
let offsetY = -window.innerHeight * 0.2;

let isDragging = false;
let startX, startY;

function updateTransform() {
  canvas.style.transform =
    `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
}
updateTransform();

/* Drag */
canvas.addEventListener("pointerdown", e => {
  isDragging = true;
  startX = e.clientX - offsetX;
  startY = e.clientY - offsetY;
  canvas.style.cursor = "grabbing";
});

window.addEventListener("pointermove", e => {
  if (!isDragging) return;
  offsetX = e.clientX - startX;
  offsetY = e.clientY - startY;
  updateTransform();
});

window.addEventListener("pointerup", () => {
  isDragging = false;
  canvas.style.cursor = "grab";
});

/* Scroll Zoom (Desktop) */
window.addEventListener("wheel", e => {
  e.preventDefault();
  const zoomAmount = -e.deltaY * 0.001;
  scale = Math.min(maxScale, Math.max(minScale, scale + zoomAmount));
  updateTransform();
}, { passive: false });

/* Pinch Zoom (Mobile) */
let lastDistance = null;

window.addEventListener("touchmove", e => {
  if (e.touches.length === 2) {
    const dx = e.touches[0].clientX - e.touches[1].clientX;
    const dy = e.touches[0].clientY - e.touches[1].clientY;
    const distance = Math.sqrt(dx*dx + dy*dy);

    if (lastDistance) {
      const zoomAmount = (distance - lastDistance) * 0.005;
      scale = Math.min(maxScale, Math.max(minScale, scale + zoomAmount));
      updateTransform();
    }
    lastDistance = distance;
  }
}, { passive: false });

window.addEventListener("touchend", () => {
  lastDistance = null;
});

/* Music auto-play assist */
const music = document.getElementById("bgm");
window.addEventListener("pointerdown", () => {
  if (music.paused) music.play();
}, { once: true });
</script>

</body>
</html>